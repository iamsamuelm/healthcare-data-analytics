---
title: "Hepatitis Education & Outreach"
author: Samuel Muma, Adharsh Maheswaran, Chantel Orimoloye, Mikhail Tabong, Omodara
  Ojebuoboh
date: "`r Sys.Date()`"
output: html_document
---

# Importing dataset

```{r}

# Required packages
required_packages <- c("readr", "dplyr", "tidyr") 

new_packages <- required_packages[!required_packages %in% installed.packages()]
if (length(new_packages) > 0) {
  install.packages(new_packages)
}

library(readr)
library(dplyr)
library(tidyr)

# Read in CSV
hepatitis_df <- read_csv("hepatitis.csv")
head(hepatitis_df)

```

# 1. Data Preprocessing

a. Handle missing values appropriately

```{r}
# Getting the most frequent value (mode) for binary categorical columns
binary_columns <- c("Steroid", "Liver Big", "Liver Firm", 
                    "Spleen Palpable", "Spiders", "Ascites", "Varices")

# Helper funciton to impute missing values with the mode
impute_mode <- function(col) {
  mode_value <- as.numeric(names(sort(table(col), decreasing = TRUE))[1])
  col[is.na(col)] <- mode_value
  return(col)
}

# Apply imputation
hepatitis_df[binary_columns] <- lapply(hepatitis_df[binary_columns], impute_mode)

# Handling Nominal columns
mean_to_impute <- c("Bilirubin", "Alk Phosphate", "Sgot")
median_to_impute <- c("Albumin", "Protime")

# Helper function to impute missing values with the mean or median
impute_with <- function(data, columns, method = "mean") {
  for (col in columns) { # Fix: Added parentheses around "col in columns"
    if (method == "mean") {
      impute_value <- mean(data[[col]], na.rm = TRUE)
    } else if (method == "median") {
      impute_value <- median(data[[col]], na.rm = TRUE) 
    } else {
      stop("Invalid method. Please use 'mean' or 'median'.")
    }
    # Impute N/A in the specified column
    data[[col]][is.na(data[[col]])] <- impute_value
  }
  return(data)
}

# Impute using mean & median
hepatitis_df <- impute_with(hepatitis_df, mean_to_impute, method = "mean")
hepatitis_df <- impute_with(hepatitis_df, median_to_impute, method = "median")
head(hepatitis_df)

```

b. Encode categorical variables as needed

```{r}
# Columns to re-code (1 = No (except Sex where Sex = Male & Class 1 = Die), 2 = No (except Sex where Sex = Female & Class 2 = Yes))
to_recode <- c("Sex", "Steroid", "Antivirals", "Fatigue",
               "Malaise","Anorexia", "Liver Big", "Liver Firm", 
               "Spleen Palpable", "Spiders", "Ascites", "Varices",
               "Histology", "Class")

# Function to recode 1's to 1's and 2's to 0's
recode_binary <- function(column, column_name) {
  if (column_name == "Sex") {
    #For Sex: 1 = Male, 2 = Female
    return(ifelse(column == 2, 0, 1)) # 1 = Male, 0 = Female
  } else if (column_name == "Class") {
    # For Class: 1 = Die, 2 = Live
    return(ifelse(column == 2, 1, 0)) # 1 = Live, 0 = Die
  } else {
    # For other columns: 1 = No, 2 = Yes
    return(ifelse(column == 2, 1, 0)) # 1 = Yes, 0 = No
  }
}

# Applying the re-coding function
for (col in to_recode) {
  hepatitis_df[[col]] <- recode_binary(hepatitis_df[[col]], col)
}

# Convert 'Class' to a factor
hepatitis_df$Class <- factor(hepatitis_df$Class, levels = c(0, 1), labels = c("Die", "Live"))
```

c. Normalize or standardize features if required

```{r}
# Checking summary statistics for standardization
summary(hepatitis_df$Bilirubin)
summary(hepatitis_df$`Alk Phosphate`)
summary(hepatitis_df$Sgot)
summary(hepatitis_df$Protime)

# Standardizing necessary features
features_to_scale <- c("Bilirubin", "Alk Phosphate", "Sgot", "Protime")
hepatitis_df[features_to_scale] <- scale(hepatitis_df[features_to_scale])
summary(hepatitis_df[features_to_scale])
```

